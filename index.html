<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name = "viewport" content="width=device-width, initial-scale=1.0">
        <title>상산고등학교 신강의동 신청 페이지</title>
        <h1> [상산고등학교 신강의동 신청]</h1>
        <p> 안녕하세요. 전진 학생회 시설관리부입니다. </p>
        <p>평일 점심시간 및 SSEP 시간 (금요일 5,6교시) 신강의동 신청 방법에 관하여 안내드립니다.</p>
        <p>점심시간과 SSEP 시간 신강의동 신청은 해당 홈페이지에서 진행됩니다.</p>
        <strong style = "color:red">저녁 시간 및 주말 신강의동 이용은 학생회 담당이 아닙니다.</strong>
        <hr>
        <h2> {안내 사항} </h2>
        <strong>[호실/사용시간(점심1, 점심2, 5교시, 6교시)/대표자 이름/학번/사용 인원/A팀 or B팀] 을 해당 란에 입력하십시오.</strong>
        <p>표에 입력값이 확인되면 신청이 완료됩니다.</p>
        <p> 점심시간 1번 : 12:00 ~ 12:40</p>
        <p> 점심시간 2번 : 12:40 ~ 13:15</p>
        <p> 금요일 5교시 : 13:20 ~ 14:10 </p>
        <p> 금요일 6교시 : 14:20 ~ 15:10 </p>
        <strong style = "color:red">단, 양식을 지키지 않은 예약은 무효 처리됩니다.</strong>
        <br>
        <hr>
        <h2> {새롭게 개편된 사항}</h2>
        <p>신청은 당일 <strong style = "color:red">오전 06시 30분</strong>부터 가능하며, 그 전에 작성된 예약은 모두 무효 처리 됩니다.</p>
        <p> <strong style = "color:red">204호, 304호, 404호</strong>는 신청 없이 자유롭게 사용하실 수 있습니다.</p>
        <p> 나머지 호실은 <strong style = "color:red">A팀, B팀</strong>에 나누어 2팀씩 신청이 진행됩니다.</p>
        <p> 신청을 한 경우 취소가 <strong style = "color:red">불가</strong>하니, 신중하게 예약해주실 바랍니다.</p>
        <br>
        <hr>
        <br>
    
    </head>
    
    <body onload="loadItems()">
        <form onsubmit="addItem(); return false;">
            <label for="대표자 이름">이름:</label>
            <input type="text" id="대표자 이름" placeholder="대표자 이름 입력..." name = "대표자 이름">
            <br>
            <label for="대표자 학번">학번:</label>
            <input type="text" id="대표자 학번" placeholder="대표자 학번 입력..." name = "대표자 학번" >
            <br>
            <label for="사용 인원">사용 인원:</label>
            <input type="text" id="사용 인원" placeholder="사용 인원 입력..." name = "사용 인원" >

            <script>
                function getCurrentTime() {
                var now =new Date();
                var year = now.getFullYear();
                var month = now.getMonth() + 1;
                var day = now.getDate();
                var hour = now.getHours();
                var minute = now.getMinutes();
                var second = now.getSeconds();
                var currentTime = year + "-" +
                                (month < 10 ? "0" + month : month) + "-" +
                                (day < 10 ? "0" + day : day) + "T" +
                                (hour < 10 ? "0" + hour : hour) + ":" +
                                (minute < 10 ? "0" + minute : minute) + ":" +
                                (second < 10 ? "0" + second : second);
                document.getElementById("time").value = currentTime;
                }
            
                setInterval(getCurrentTime, 1000);
            </script>

            <script>
                function checkTime() {
                  var now = new Date();
                  var kst = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Seoul" }));
                  var start = new Date();
                  start.setHours(24, 0, 0); // 자정
                  var end = new Date();
                  end.setHours(06, 30, 0); // 오전 6시 30분
                  var submitBtn = document.getElementById("submitBtn");

                  if (start <= kst && kst <= end) {
                    alert("자정부터 오전 6시 30분까지는 예약이 불가능합니다.");
                    return false;
                  } else {
                    return true;
                  }
                }

                function submitForm() {
                    if (checkTime()) {
                      addItem();
                    }
                  }

            </script>              
                       
            <br>
            <label for="사용 시간">사용 시간:</label>
            <select name = "사용 시간" id="사용 시간" >
                <option value="점심시간 1번">점심시간 1번</option>
                <option value="점심시간 2번">점심시간 2번</option>
                <option value="금요일 5교시">금요일 5교시</option>
                <option value="금요일 6교시">금요일 6교시</option>
            <select>
            <br>
            <label for="호실">호실:</label>
            <select name = "호실" id="호실">
                <option value="409호">409호</option>
                <option value="407호">407호</option>
                <option value="405호">405호</option>
                <option value="309호">309호</option>
                <option value="307호">307호</option>
                <option value="207호">207호</option>
                <option value="205호">205호</option>
            </select>
            &nbsp;
            <label for="A팀/B팀">A팀/B팀:</label>
            <select name = "A팀/B팀" id="A팀/B팀">
                <option value="A팀">A팀</option>
                <option value="B팀">B팀</option>
            </select>
            &nbsp;
    </body>
    <br>                   
    <body>
        </form>
        <br>
        <hr>
        <br>
        <table id="myTable" border="1" bordercolor="blue" width="700" height="50">           
             <thead>
              <tr>
                <th>학번</th>
                <th>이름</th>
                <th>사용 시간</th>
                <th>호실</th>
                <th>A팀/B팀</th>
                <th>사용 인원</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
        <br><br>
        <script>
            function addItem() {
              var name = document.getElementById("대표자 이름").value;
              var num = document.getElementById("대표자 학번").value;
              var people = document.getElementById("사용 인원").value;
              var time = document.getElementById("사용 시간").value;
              var room = document.getElementById("호실").value;
              var team = document.getElementById("A팀/B팀").value;
            
              var itemsss = {
                name: name,
                num: num,
                people: people,
                time: time,
                room: room,
                team: team,
              };
              
              var itemsd = localStorage.getItem("itemsd");
              if (itemsd) {
                itemsd = JSON.parse(itemsd);
              } else {
                itemsd = [];
              }
              
              itemsd.push(itemsss);
              localStorage.setItem("itemsd", JSON.stringify(itemsd));
            
              const table = document.getElementById("myTable");
              const row = table.insertRow();
              var numCell = row.insertCell(0);
              var nameCell = row.insertCell(1);
              var timeCell = row.insertCell(2);
              var roomCell = row.insertCell(3);
              var teamCell = row.insertCell(4);
              var peopleCell = row.insertCell(5);
              nameCell.innerHTML = name;
              numCell.innerHTML = num;
              timeCell.innerHTML = time;
              roomCell.innerHTML = room;
              peopleCell.innerHTML = people;
              teamCell.innerHTML = team;
            }
  
          </script>

          <script>   
            function loadItems() {
              var itemsd = localStorage.getItem("itemsd");
              if (itemsd) {
                itemsd = JSON.parse(itemsd);
                var table = document.getElementById("myTable");
                for (var i = 0; i < itemsd.length; i++) {
                  var itemsss = itemsd[i];
                  var name = itemsss.name;
                  var num = itemsss.num;
                  var time = itemsss.time;
                  var room = itemsss.room;
                  var team = itemsss.team;
                  var people = itemsss.people;
                  var row = table.insertRow(-1);
                  var numCell = row.insertCell(0);
                  var nameCell = row.insertCell(1);
                  var timeCell = row.insertCell(2);
                  var roomCell = row.insertCell(3);
                  var teamCell = row.insertCell(4);
                  var peopleCell = row.insertCell(5);
                  nameCell.innerHTML = name;
                  numCell.innerHTML = num;
                  timeCell.innerHTML = time;
                  roomCell.innerHTML = room;
                  peopleCell.innerHTML = people;
                  teamCell.innerHTML = team;
                }
              }
            }
            
            </script>
        <script>
            (function() {
                var currentDate = new Date();
                currentDate.setHours(24, 0, 0, 0);
                setTimeout(function() {
                  localStorage.clear();
                  console.log('로컬 스토리지가 초기화되었습니다.');
                }, currentDate.getTime() - Date.now());
              })();
        </script>

    </body>

    <br>

    <body>
        <button type="submit" id="submitBtn" onclick="submitForm()">예약</button>
    </body>

    <br><br>
    <body onload="setTime()">
        <form>
            <label for="time">현재 시간:</label>
            <input type="datetime-local" id="time" name="time" readonly>
        </form>
    </body>
   
    <br><br><br>
    <address> 개발자 정보 : 41기 30820 이주원</address>
</html>